<!-- Delete Project Button -->
{{ if .ProjectId }}
<button
  class="delete-btn"
  id="delete-project"
  hx-delete="/project/{{ .ProjectId }}"
  hx-swap-oob="true"
>
  Delete Project
</button>
{{ else }}
<button class="delete-btn" id="delete-project" hx-swap-oob="true">
  Delete Project
</button>
{{ end }}

<select
  name="asset-selector"
  id="asset-selector"
  class="asset-selector"
  hx-get="/asset/{{ .ProjectId }}"
  hx-target="#target"
  hx-swap-oob="true"
>
  {{ if .Assets }}
  <option selected value="all">All Assets</option>
  {{ range .Assets }}
  <option value="{{ .ID }}">{{ .CriticalAsset }}</option>
  {{ end }} {{ else }}
  <option selected disabled>NONE</option>
  {{ end }}
</select>

<!-- Impact Priority -->
<div class="prior" id="prior" hx-swap-oob="true">
  {{ with .AreaPriority }}
  <h3 style="width: 5rem">Impact Areas Priority</h3>
  <table>
    <thead>
      <tr>
        <th>Field</th>
        <th>1</th>
        <th>2</th>
        <th>3</th>
        <th>4</th>
        <th>5</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="text-align: left">Reputation and Customer Confidence</td>
        {{ if eq .ReputationConfidence 1 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .ReputationConfidence 2 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .ReputationConfidence 3 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .ReputationConfidence 4 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .ReputationConfidence 5 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }}
      </tr>
      <tr>
        <td style="text-align: left">Financial</td>
        {{ if eq .Financial 1 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Financial 2 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Financial 3 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Financial 4 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Financial 5 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }}
      </tr>
      <tr>
        <td style="text-align: left">Productivity</td>
        {{ if eq .Productivity 1 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Productivity 2 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Productivity 3 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Productivity 4 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .Productivity 5 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }}
      </tr>
      <tr>
        <td style="text-align: left">Safety and Health</td>
        {{ if eq .SafetyHealth 1 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .SafetyHealth 2 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .SafetyHealth 3 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .SafetyHealth 4 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .SafetyHealth 5 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }}
      </tr>
      <tr>
        <td style="text-align: left">Fines and Legal Penalties</td>
        {{ if eq .FinesLegalPenalties 1 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .FinesLegalPenalties 2 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .FinesLegalPenalties 3 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .FinesLegalPenalties 4 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }} {{ if eq .FinesLegalPenalties 5 }}
        <td>✅</td>
        {{ else }}
        <td></td>
        {{ end }}
      </tr>
    </tbody>
  </table>
  {{ else }}
  <h4>Impact Areas Priority</h4>
  {{ end }}
</div>

<!-- Total Assets -->
<div class="total-assets" id="total-assets" hx-swap-oob="true">
  <h3>Total Assets</h3>
  {{ if .TotalAssets }} {{ if gt .TotalAssets 0 }}
  <p>{{ .TotalAssets }}</p>
  {{ end }} {{ else }}
  <p>0</p>
  {{ end }}
</div>

<!-- Total Risks -->
<div class="total-risks" id="total-risks" hx-swap-oob="true">
  <h3>Total Risks</h3>
  {{ if .TotalRisks }} {{ if gt .TotalRisks 0 }}
  <p>{{ .TotalRisks }}</p>
  {{ end }} {{ else }}
  <p>0</p>
  {{ end }}
</div>

<!-- Total Projects -->
<div class="total-projects" id="total-projects" hx-swap-oob="true">
  <h3>Total Projects</h3>
  {{ if .TotalProjects }} {{ if gt .TotalProjects 0 }}
  <p>{{ .TotalProjects }}</p>
  {{ end }} {{ else }}
  <p>0</p>
  {{ end }}
</div>

<!-- Add  -->
<div
  class="container-row-btn"
  style="margin-top: 0.2rem"
  id="add-btn"
  hx-swap-oob="true"
>
  {{ if .ProjectId }}
  <a class="asset_btn" href="/add-profile/{{ .ProjectId }}" style="width: 43%"
    >Add Asset Pofile</a
  >
  <a class="risk_btn" href="/add-risk/{{ .ProjectId }}" style="width: 55%"
    >Add Risk & Mitigation</a
  >
  {{ else }}
  <a class="asset_btn" style="width: 43%">Add Asset Pofile</a>
  <a class="risk_btn" style="width: 55%">Add Risk & Mitigation</a>
  {{ end }}
</div>

<!-- Content -->
<div class="container-content" id="container-content" hx-swap-oob="true">
  {{ range .Contents }}
  <div class="content">
    <div class="front">
      <div class="bot">
        <div class="sec" style="min-width: 10rem; max-width: 14rem">
          <h3>Area of Concern:</h3>
          <p>{{ .AreaOfConcern }}</p>
        </div>

        <div class="sec" style="min-width: 9rem">
          <h5>Actor:</h5>
          <p>{{ .Actor }}</p>

          <h5>Motive:</h5>
          <p>{{ .Motive }}</p>
        </div>

        <div class="sec" style="min-width: 9rem">
          <h5>Means:</h5>
          <p>{{ .Means }}</p>
          <h5>Outcome:</h5>
          <p>{{ .Outcome }}</p>
        </div>

        <div class="sec">
          <h5 style="min-width: 10rem">Security Requirement:</h5>
          <p>{{ .SecurityRequirement }}</p>
          <h5>Probability:</h5>
          <p>{{ .Probability }}</p>
        </div>

        <div class="sec" style="min-width: 9rem">
          <h5>Consequences:</h5>
          <p>{{ .Consequences }}</p>
          <h5>Relative Score:</h5>
          <p>{{ .RelativeScore }}</p>
        </div>
      </div>
    </div>
    <div class="back">
      <h3>Mitigation Approach: {{ .CategoryStr }}</h3>

      <div class="bot">
        <div class="sec">
          <h5>Action/Control (Technical):</h5>
          <p>{{ .TechnicalAction }}</p>
        </div>

        <div class="sec">
          <h5>Action/Control (Physical):</h5>
          <p>{{ .PhysicalAction }}</p>
        </div>

        <div class="sec">
          <h5>Action/Control (People):</h5>
          <p>{{ .PeopleAction }}</p>
        </div>
      </div>
    </div>
  </div>
  {{ else }}
  <div style="background-color: var(--mirage)">
    <h1 style="margin: 10rem 28rem">NONE</h1>
  </div>
  {{ end }}
</div>

<!-- script -->
<div class="container-chart" id="container-chart" hx-swap-oob="true">
  <canvas id="myChart" width="130" height="130"></canvas>
</div>

<script id="script" hx-swap-oob="true" hx-on="htmx:afterSwap">
  function myCallBack() {
    const ctx = document.getElementById("myChart");

    Chart.defaults.color = "#FFFFFF";
    Chart.defaults.borderColor = "rgba(255, 255, 255, 0.3)";
    Chart.defaults.font.size = 10;

    new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["Category 1", "Category 2", "Category 3", "Category 4"],
        datasets: [
          {
            label: "Risks",
            data: [
              "{{ .Category1 }}",
              "{{ .Category2 }}",
              "{{ .Category3 }}",
              "{{ .Category4 }}",
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
          },
        },
        plugins: {
          legend: {
            labels: {
              font: {
                size: 14,
              },
            },
          },
        },
      },
    });
  }

  myCallBack();
</script>
